!function(t,i){"object"==typeof exports&&"undefined"!=typeof module?i(require("video.js")):"function"==typeof define&&define.amd?define(["video.js"],i):i(t.videojs)}(this,function(t){"use strict";const i=videojs.getComponent("Component");videojs.registerComponent("videoTooltip",class extends i{constructor(t,i){super(t,i),this.height=i.height||90,this.width=160,this.duration=i.duration||5,this.isSupported=!1,this.currentTime=0,this.video=null,this.debounceVideo=function(t,i,e){var s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:window_1,h=void 0;return function(){var o=this,d=arguments,n=function(){h=null,n=null,e||t.apply(o,d)};!h&&e&&t.apply(o,d),s.clearTimeout(h),h=s.setTimeout(n,i)}}(this.changeRange.bind(this),250,!1,this),this.player_.ready(()=>this.initVideo()),this.on(this.player_,["sourcechange","sourceset","loadedmetadata","resize","fullscreenchange"],()=>this.setSize())}initVideo(){this.isSupported="Html5"===this.player_.techName_,this.isSupported?(this.video=document.createElement("video"),this.video.muted=!0,this.video.loop=!0,this.video.autoplay=!0,this.video.controls=!1,this.setSize()&&(this.video.setAttribute("playsinline","playsinline"),this.el_.appendChild(this.video))):this.hide()}setSize(){let t=this.height/this.player_.videoHeight();return this.width=this.player_.videoWidth()*t,this.video.height=this.height,this.video.width=this.width,!(this.width>this.player_.currentWidth()/2&&(this.isSupported=!1,this.video=null,this.hide(),1))}changeRange(){this.video.src=`${this.player_.src()}#t=${this.currentTime},${this.currentTime+this.duration}`}createEl(){return super.createEl("div",{className:"vjs-video-tooltip"})}update(t,i){if(this.isSupported){var e=i*this.player_.duration()|0,s=function(t){if(t&&t.getBoundingClientRect&&t.parentNode){var i=t.getBoundingClientRect(),e={};return["bottom","height","left","right","top","width"].forEach(function(t){void 0!==i[t]&&(e[t]=i[t])}),e.height||(e.height=parseFloat(computedStyle(t,"height"))),e.width||(e.width=parseFloat(computedStyle(t,"width"))),e}}(this.player_.el()),h=t.width*i;if(s){var o=t.left-s.left+h,d=t.width-h+(s.right-t.right),n=this.width/2,r=this.height;o<n?n+=n-o:d<n&&(n=d),n<0?n=0:n>this.width&&(n=this.width),this.el_.style.right=`-${n}px`,this.el_.style.top=`-${r}px`,this.currentTime-5<e&&this.currentTime+this.duration>e||!this.video||(this.currentTime=e,this.debounceVideo())}}}});const e=videojs.getComponent("MouseTimeDisplay");class s extends e{update(i,e){this.rafId_&&this.cancelAnimationFrame(this.rafId_),this.rafId_=this.requestAnimationFrame(()=>{var s=this.player_.duration(),h=t.formatTime(e*s,s);this.el_.style.left=i.width*e+"px",this.getChild("timeTooltip").update(i,e,h),this.getChild("videoTooltip").update(i,e)})}}s.prototype.options_={children:["videoTooltip","timeTooltip"]},videojs.registerComponent("mouseTimeDisplay",s)});
