/**
 * videojs-dvr
 * @version 1.4.0
 * @copyright 2019 ff.fernandez.facundo <ff.fernandez.facundo@gmail.com>
 * @license MIT
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("video.js")):"function"==typeof define&&define.amd?define(["video.js"],t):e.videojsDvr=t(e.videojs)}(this,function(a){"use strict";a=a&&a.hasOwnProperty("default")?a.default:a;var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t={},r=Object.freeze({default:t}),n=r&&t||r,o=void 0!==e?e:"undefined"!=typeof window?window:{},c="undefined"!=typeof document?document:o["__GLOBAL_DOCUMENT_CACHE@4"]||(o["__GLOBAL_DOCUMENT_CACHE@4"]=n);"function"==typeof Symbol&&Symbol.asyncIterator&&(i.prototype[Symbol.asyncIterator]=function(){return this}),i.prototype.next=function(e){return this._invoke("next",e)},i.prototype.throw=function(e){return this._invoke("throw",e)},i.prototype.return=function(e){return this._invoke("return",e)};function u(e){this.value=e}function i(o){var i,a;function s(e,t){try{var r=o[e](t),n=r.value;n instanceof u?Promise.resolve(n.value).then(function(e){s("next",e)},function(e){s("throw",e)}):l(r.done?"return":"normal",r.value)}catch(e){l("throw",e)}}function l(e,t){switch(e){case"return":i.resolve({value:t,done:!0});break;case"throw":i.reject(t);break;default:i.resolve({value:t,done:!1})}(i=i.next)?s(i.key,i.arg):a=null}this._invoke=function(n,o){return new Promise(function(e,t){var r={key:n,arg:o,resolve:e,reject:t,next:null};a?a=a.next=r:(i=a=r,s(n,o))})},"function"!=typeof o.return&&(this.return=void 0)}var s={startTime:0,timeLive:3600},l=0,p=s.timeLive,d=a.registerPlugin||a.plugin,f=a.getComponent("Button"),h=a.getComponent("Component"),v=a.getComponent("ProgressControl"),y=v.getComponent("SeekBar"),_=v.getComponent("PlayProgressBar"),m=a.getComponent("MouseTimeDisplay");v.getComponent("LoadProgressBar").prototype.update=function(e){function t(e,t){var r=e/t||0;return 100*(1<=r?1:r)+"%"}var r=this.player_.buffered(),n=this.player_.duration(),o=this.player_.bufferedEnd(),i=this.partEls_;0!==t(o,n)&&(this.el_.style.width=t(o,n));for(var a=0;a<r.length;a++){var s=r.start(a),l=r.end(a),u=i[a];u||(u=this.el_.appendChild(c.createElement("div")),i[a]=u),0!==t(s,o)&&(u.style.left=t(s,o)),0!==t(l-s,o)&&(u.style.width=t(l-s,o))}for(var p=i.length;p>r.length;p--)this.el_.removeChild(i[p-1]);i.length=r.length},y.prototype.update_=function(e,t){var r=this.player_.duration(),n=this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime();this.el_.setAttribute("aria-valuenow",(100*t).toFixed(2)),r!==Number.POSITIVE_INFINITY&&this.el_.setAttribute("aria-valuetext","-"+a.formatTime(r-n,r)),this.bar.update(a.dom.getBoundingClientRect(this.el_),t)},y.prototype.handleMouseMove=function(e){var t=1-this.calculateDistance(e),r=this.player_.seekable().end(0)-t*p;r===this.player_.duration()&&(r-=.1),this.player_.currentTime(r),this.update()},_.prototype.update=function(r,n){var o=this,i=this.player_.duration();this.rafId_&&this.cancelAnimationFrame(this.rafId_),this.rafId_=this.requestAnimationFrame(function(){var e=o.player_.scrubbing()?o.player_.getCache().currentTime:o.player_.currentTime(),t=a.formatTime(i-e,i);0!==n&&i!==Number.POSITIVE_INFINITY&&o.getChild("timeTooltip").update(r,n,"-"+t)})},m.prototype.update=function(t,r){var n=this;this.rafId_&&this.cancelAnimationFrame(this.rafId_),this.rafId_=this.requestAnimationFrame(function(){var e=a.formatTime(p-r*p,p);n.el_.style.left=t.width*r+"px",0!==r&&n.player_.duration()!==Number.POSITIVE_INFINITY&&n.getChild("timeTooltip").update(t,r,"-"+e)})};function b(e){var t=this;e=e||s,this.on("timeupdate",function(e){!function(e){var t=e.seekable();t&&t.length&&(t.end(0)-e.currentTime()<20?e.controlBar.liveButton.addClass("onair"):e.controlBar.liveButton.removeClass("onair"),e.duration(e.seekable().end(0)),l=l||(p=e.seekable().end(0)))}(t)}),this.on("pause",function(e){t.controlBar.liveButton.removeClass("onair")}),this.ready(function(){!function(e){e.addClass("vjs-dvr"),e.controlBar.addClass("vjs-dvr-control-bar"),e.controlBar.progressControl.seekBar.__proto__.__proto__.update=function(){if(this.el_){var e=void 0;e="VolumeBar"===this.name_?this.getPercent():1-(this.player_.duration()-this.player_.currentTime())/p;var t=this.bar;if(t){("number"!=typeof e||e!=e||e<0||e===1/0)&&(e=0),1<e&&(e=1);var r=(100*e).toFixed(2)+"%",n=t.el().style;return 0!==e&&(this.vertical()?n.height=r:n.width=r),e}}},e.controlBar.progressControl&&e.controlBar.progressControl.addClass("vjs-dvr-progress-control"),e.controlBar.liveButton=e.controlBar.addChild("liveButton"),e.controlBar.el().insertBefore(e.controlBar.liveButton.el(),e.controlBar.progressControl.el())}(t,a.mergeOptions(s,e))})}var C,g=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(B,C=f),B.prototype.buildCSSClass=function(){return"vjs-live-button "+C.prototype.buildCSSClass.call(this)},B.prototype.handleClick=function(e){var t=this.player_.seekable().end(0);this.player_.currentTime(t),this.player_.play()},B);function B(e,t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,B);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,C.call(this,e,t));return r.el().innerHTML='<span class="liveCircle"></span><span class="liveText">LIVE</span>',e.paused()||r.addClass("onair"),r}return h.registerComponent("LiveButton",g),d("dvr",b),b.VERSION="1.4.0",b});